# Pong (iTango 网络探测) - UI 设计文档

## 目录

- [一、应用概述](#一应用概述)
- [二、页面导航结构](#二页面导航结构)
  - [2.1 主导航 (TabView)](#21-主导航-tabview)
- [三、Tab 1 - 本地测 (HomeView)](#三tab-1---本地测-homeview)
  - [3.1 页面结构](#31-页面结构)
  - [3.2 样式规范](#32-样式规范)
- [四、工具详情页面](#四工具详情页面)
  - [4.1 Ping 页面 (PingView)](#41-ping-页面-pingview)
  - [4.2 Traceroute 页面 (TraceView)](#42-traceroute-页面-traceview)
  - [4.3 DNS 页面 (DNSView)](#43-dns-页面-dnsview)
  - [4.4 TCP 页面 (TCPView)](#44-tcp-页面-tcpview)
  - [4.5 UDP 页面 (UDPView)](#45-udp-页面-udpview)
  - [4.6 HTTP 页面 (HTTPGetView)](#46-http-页面-httpgetview)
  - [4.7 测速页面 (SpeedTestView)](#47-测速页面-speedtestview)
  - [4.8 设备信息页面 (DeviceInfoView)](#48-设备信息页面-deviceinfoview)
  - [4.9 一键诊断页面 (QuickDiagnosisView)](#49-一键诊断页面-quickdiagnosisview)
- [五、Tab 2 - 云探测 (CloudProbeView)](#五tab-2---云探测-cloudprobeview)
  - [5.1 页面结构](#51-页面结构)
  - [5.2 样式规范](#52-样式规范)
- [六、Tab 3 - IP查询 (IPQueryView)](#六tab-3---ip查询-ipqueryview)
  - [6.1 页面结构](#61-页面结构)
  - [6.2 样式规范](#62-样式规范)
- [七、Tab 4 - 数据 (ChinaMapView)](#七tab-4---数据-chinamapview)
  - [7.1 页面结构](#71-页面结构)
  - [7.2 样式规范](#72-样式规范)
- [八、Tab 5 - 我的 (ProfileView)](#八tab-5---我的-profileview)
  - [8.1 页面结构](#81-页面结构)
  - [8.2 登录后状态](#82-登录后状态)
  - [8.3 样式规范](#83-样式规范)
- [九、登录页面 (LoginView)](#九登录页面-loginview)
  - [9.1 页面结构](#91-页面结构)
  - [9.2 样式规范](#92-样式规范)
- [十、设置页面 (SettingsView)](#十设置页面-settingsview)
  - [10.1 页面结构](#101-页面结构)
- [十一、任务历史页面 (TaskHistoryView)](#十一任务历史页面-taskhistoryview)
  - [11.1 页面结构](#111-页面结构)
  - [11.2 样式规范](#112-样式规范)
- [十二、关于页面 (AboutView)](#十二关于页面-aboutview)
- [十三、抓包页面 (PacketCaptureView)](#十三抓包页面-packetcaptureview)
  - [13.1 页面结构](#131-页面结构)
  - [13.2 样式规范](#132-样式规范)
- [十四、通用 UI 组件](#十四通用-ui-组件)
  - [14.1 Toast 提示](#141-toast-提示)
  - [14.2 加载指示器](#142-加载指示器)
  - [14.3 空状态视图](#143-空状态视图)
- [十五、颜色规范](#十五颜色规范)
  - [15.1 主题色](#151-主题色)
  - [15.2 背景色](#152-背景色)
- [十六、字体规范](#十六字体规范)
- [十七、间距规范](#十七间距规范)
- [十八、圆角规范](#十八圆角规范)
- [十九、页面跳转关系](#十九页面跳转关系)
- [二十、动画效果](#二十动画效果)
  - [20.1 页面转场](#201-页面转场)
  - [20.2 状态变化](#202-状态变化)
  - [20.3 加载动画](#203-加载动画)
- [二十一、深色模式支持](#二十一深色模式支持)

---

## 一、应用概述

**应用名称**: iTango 网络探测  
**平台**: iOS  
**框架**: SwiftUI  
**设计风格**: 现代简洁，支持深色模式  
**语言支持**: 中文 / 英文

---

## 二、页面导航结构

### 2.1 主导航 (TabView)

```
┌─────────────────────────────────────────────────────┐
│                                                     │
│                  [页面内容区域]                      │
│                                                     │
├─────────────────────────────────────────────────────┤
│  📱本地测  │  ☁️云探测  │  🔍IP查询  │  📊数据  │  👤我的  │
└─────────────────────────────────────────────────────┘
```

**Tab 配置**:
| Tab | 图标 | 中文标题 | 英文标题 | 对应视图 |
|-----|------|----------|----------|----------|
| 本地测 | `iphone.gen1` | 本地测 | Local | `HomeView` |
| 云探测 | `icloud` | 云探测 | Cloud | `CloudProbeView` |
| IP查询 | `magnifyingglass` | IP查询 | IP Query | `IPQueryView` |
| 数据 | `apple.intelligence` | 数据 | Data | `ChinaMapView` |
| 我的 | `person` | 我的 | Profile | `ProfileView` |

**主题色**: `.blue` (TabView tint)

---

## 三、Tab 1 - 本地测 (HomeView)

### 3.1 页面结构

```
┌─────────────────────────────────────────┐
│ 导航栏: "iTango"          [语言切换] ⚙️ │
├─────────────────────────────────────────┤
│         [iTango Logo 图片]              │  ← 现代样式显示
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │ 一键诊断卡片                         │ │
│ │ 输入诊断码，快速定位网络问题          │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 网络工具                                 │
│ ┌───────┐ ┌───────┐ ┌───────┐          │
│ │ Ping  │ │  DNS  │ │  TCP  │          │
│ └───────┘ └───────┘ └───────┘          │
│ ┌───────┐ ┌───────┐ ┌───────┐          │
│ │  UDP  │ │Tracert│ │ HTTP  │          │
│ └───────┘ └───────┘ └───────┘          │
│ ┌───────┐ ┌───────┐ ┌───────┐          │
│ │本机信息│ │ 测速  │ │ 抓包  │          │
│ └───────┘ └───────┘ └───────┘          │
│                                         │
│ 快速诊断                                 │
│ ┌─────────────────────────────────────┐ │
│ │ 🌐 华佗平台                          │ │
│ │    网络质量诊断与分析平台             │ │
│ └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

### 3.2 样式规范

#### 导航栏
- **标题**: "iTango"
- **标题样式**: `.inline`
- **右侧按钮**:
  - 语言切换按钮: 显示 "EN" 或 "中"
  - 设置按钮: `gear` 图标

#### Logo 显示区域 (现代样式)
- **显示条件**: 首页样式为"现代"时显示
- **图片**: 根据深色模式切换
  - 浅色模式: `itango_logo`
  - 深色模式: `itango_night_logo`
- **高度**: 70pt
- **缩放模式**: `.scaledToFit`

#### 一键诊断卡片
- **背景**: 背景图片 `dig_bg`
  - 使用 `.resizable()` + `.aspectRatio(contentMode: .fill)`
- **圆角**: 16pt
- **阴影**: `shadow(color: .blue.opacity(0.3), radius: 10, x: 0, y: 5)`
- **内边距**: 20pt
- **图标**: `wand.and.stars` (白色, 28pt)
- **标题字体**: `.title3`, `.bold`, 白色
- **描述字体**: `.subheadline`, 白色 0.9 透明度

#### 网络工具区域
- **标题字体**: `.headline`, `.semibold`
- **工具卡片布局**: `LazyVGrid`, 可配置 2/3/4 列
- **工具卡片样式** (现代风格):
  - 背景: `Color(.systemBackground)`
  - 圆角: 12pt
  - 阴影: `shadow(color: .black.opacity(0.05), radius: 5, x: 0, y: 2)`
  - 图标圆形背景: 36pt, 主题色 0.15 透明度
  - 图标大小: 18pt
  - 标题字体: `.subheadline`, `.medium`
  - 描述字体: `.caption`, `.secondary`

#### 快速诊断区域
- **标题字体**: `.headline`, `.semibold`
- **卡片样式**:
  - 背景: `Color(.systemBackground)`
  - 圆角: 12pt
  - 阴影: `shadow(color: .black.opacity(0.05), radius: 5, x: 0, y: 2)`
  - 内边距: 12pt
  - 图标大小: 24pt
  - 标题字体: `.subheadline`, `.medium`
  - 描述字体: `.caption`, `.secondary`

#### 工具图标配色
| 工具 | 图标 | 颜色 |
|------|------|------|
| 测速 | `speedometer` | `.red` |
| Ping | `network` | `.blue` |
| Traceroute | `point.topleft.down.curvedto.point.bottomright.up` | `.purple` |
| TCP | `arrow.left.arrow.right` | `.orange` |
| UDP | `paperplane` | `.green` |
| DNS | `server.rack` | `.cyan` |
| HTTP | `globe` | `.teal` |
| 抓包 | `antenna.radiowaves.left.and.right` | `.pink` |
| 本机信息 | `iphone.gen3` | `.indigo` |

---

## 四、工具详情页面

### 4.1 Ping 页面 (PingView)

```
┌─────────────────────────────────────────┐
│ ← Ping                                  │
├─────────────────────────────────────────┤
│ 目标地址                                 │
│ ┌─────────────────────────────────────┐ │
│ │ www.qq.com                     [X]  │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 高级设置 (可折叠)                        │
│ ┌─────────────────────────────────────┐ │
│ │ 发包大小: [56] [128] [512] [1024]   │ │
│ │ 发包间隔: [0.2s] [0.5s] [1s] [2s]   │ │
│ │ 最大次数: ────●────── 200           │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │         [开始 Ping]                 │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 统计信息                                 │
│ ┌───────┬───────┬───────┬───────┐      │
│ │ 发送  │ 接收  │ 丢包率 │ 平均延迟│      │
│ │  10   │  10   │  0%   │ 25ms  │      │
│ └───────┴───────┴───────┴───────┘      │
│                                         │
│ Ping 结果列表                            │
│ ┌─────────────────────────────────────┐ │
│ │ #1 ● 1.2.3.4  25.3ms               │ │
│ │ #2 ● 1.2.3.4  24.1ms               │ │
│ │ #3 ● 1.2.3.4  26.8ms               │ │
│ └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

#### 样式规范

**输入框**:
- 背景: `Color(.systemGray6)`
- 圆角: 10pt
- 内边距: 12pt
- 字体: `.body`
- 键盘类型: `.URL`

**高级设置**:
- 折叠控件: `DisclosureGroup`
- 选项按钮: `Picker` + `segmented` 样式
- 滑块: `Slider`

**开始按钮**:
- 背景: `.blue` (空闲) / `.red` (运行中)
- 前景色: `.white`
- 字体: `.headline`
- 圆角: 12pt
- 内边距: 16pt (垂直)

**统计卡片**:
- 布局: 4 列等宽
- 背景: `Color(.systemBackground)`
- 圆角: 12pt
- 标签字体: `.caption`, `.secondary`
- 数值字体: `.headline`, `.semibold`

**结果列表**:
- 列表样式: `.plain`
- 行高: 自适应
- 状态指示器: 圆点 (绿色=成功, 红色=超时)
- 延迟颜色:
  - < 50ms: `.green`
  - 50-150ms: `.orange`
  - > 150ms: `.red`

---

### 4.2 Traceroute 页面 (TraceView)

```
┌─────────────────────────────────────────┐
│ ← 路由追踪                               │
├─────────────────────────────────────────┤
│ 目标地址                                 │
│ ┌─────────────────────────────────────┐ │
│ │ www.qq.com                          │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 高级设置                                 │
│ ┌─────────────────────────────────────┐ │
│ │ 每跳探测次数: [3] [5] [10] [20]     │ │
│ │ IP协议偏好: [系统默认] [IPv4] [IPv6]│ │
│ └─────────────────────────────────────┘ │
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │         [开始追踪]                  │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 追踪进度: ████████░░░░░░░░ 12/30        │
│                                         │
│ # │ IP地址          │ 延迟   │ 丢包    │
│ ──┼─────────────────┼────────┼─────────│
│ 1 │ 192.168.1.1     │ 1.2ms  │ 0%      │
│   │ 广东 电信                          │
│ 2 │ 10.0.0.1        │ 5.3ms  │ 0%      │
│   │ 广东 电信                          │
│ 3 │ *               │ *      │ 100%    │
└─────────────────────────────────────────┘
```

#### 样式规范

**跳点列表**:
- 表头: 固定, 灰色背景
- 跳数列宽: 20pt
- IP 列: 自适应
- 延迟列宽: 60pt
- 丢包列宽: 45pt
- 字体: `.system(size: 12, design: .monospaced)`

**归属地显示**:
- 字体: `.system(size: 10)`
- 颜色: `.blue`

**丢包率颜色**:
- 0%: `.green`
- 1-49%: `.orange`
- 50%+: `.red`

**延迟颜色**:
- < 50ms: `.green`
- 50-150ms: `.orange`
- 150ms+: `.red`

---

### 4.3 DNS 页面 (DNSView)

```
┌─────────────────────────────────────────┐
│ ← DNS 查询                              │
├─────────────────────────────────────────┤
│ 域名                                     │
│ ┌─────────────────────────────────────┐ │
│ │ www.qq.com                          │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 记录类型                                 │
│ [系统默认] [A] [AAAA] [CNAME] [MX] [TXT]│
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │         [开始查询]                  │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 查询结果                                 │
│ ┌─────────────────────────────────────┐ │
│ │ 查询耗时: 12.5ms                    │ │
│ │ DNS服务器: 系统默认                  │ │
│ ├─────────────────────────────────────┤ │
│ │ [A] 1.2.3.4          TTL: 300      │ │
│ │     广东 深圳 电信                   │ │
│ │ [A] 5.6.7.8          TTL: 300      │ │
│ │     广东 广州 电信                   │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ dig 风格输出                             │
│ ┌─────────────────────────────────────┐ │
│ │ ; <<>> Pong DNS <<>> www.qq.com    │ │
│ │ ;; Got answer:                     │ │
│ │ ;; ANSWER SECTION:                 │ │
│ │ www.qq.com. 300 IN A 1.2.3.4       │ │
│ └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

#### 样式规范

**记录类型选择器**:
- 布局: `ScrollView(.horizontal)`
- 按钮样式: 胶囊形
- 选中状态: 蓝色背景, 白色文字
- 未选中状态: 灰色背景, 主色文字

**记录类型颜色**:
| 类型 | 颜色 |
|------|------|
| A | `.blue` |
| AAAA | `.purple` |
| CNAME | `.orange` |
| MX | `.green` |
| TXT | `.gray` |
| NS | `.cyan` |

**dig 输出区域**:
- 字体: `.system(size: 11, design: .monospaced)`
- 背景: `Color(.systemBackground)`
- 支持横向滚动

---

### 4.4 TCP 页面 (TCPView)

```
┌─────────────────────────────────────────┐
│ ← TCP 端口测试                          │
├─────────────────────────────────────────┤
│ 目标地址                                 │
│ ┌─────────────────────────────────────┐ │
│ │ www.qq.com                          │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 端口                                     │
│ ┌─────────────────────────────────────┐ │
│ │ 443                                 │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 常用端口                                 │
│ [21] [22] [80] [443] [3306] [8080]      │
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │         [开始测试]                  │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 测试结果                                 │
│ ┌─────────────────────────────────────┐ │
│ │ ● 端口 443 (HTTPS)                  │ │
│ │   状态: 开放                        │ │
│ │   延迟: 25.3ms                      │ │
│ └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

#### 样式规范

**端口状态指示**:
- 开放: 绿色圆点 + "开放" 文字
- 关闭: 红色圆点 + "关闭" 文字

**常用端口按钮**:
- 布局: `FlowLayout` 或 `LazyVGrid`
- 样式: 胶囊形按钮
- 点击效果: 填充端口输入框

---

### 4.5 UDP 页面 (UDPView)

结构与 TCP 页面类似，主要区别:
- 常用端口不同: 53, 67, 123, 161, 514, 5353
- 结果显示: 发送状态 + 接收状态

---

### 4.6 HTTP 页面 (HTTPGetView)

```
┌─────────────────────────────────────────┐
│ ← HTTP GET 测试                         │
├─────────────────────────────────────────┤
│ URL                                      │
│ ┌─────────────────────────────────────┐ │
│ │ https://www.qq.com                  │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 常用 URL                                 │
│ [QQ] [百度] [Google] [GitHub] [httpbin] │
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │         [发送请求]                  │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 响应信息                                 │
│ ┌─────────────────────────────────────┐ │
│ │ 状态码: 200 OK                      │ │
│ │ 响应时间: 156ms                     │ │
│ ├─────────────────────────────────────┤ │
│ │ 响应头                              │ │
│ │ Content-Type: text/html             │ │
│ │ Content-Length: 12345               │ │
│ ├─────────────────────────────────────┤ │
│ │ 响应体 (可折叠)                     │ │
│ │ <!DOCTYPE html>...                  │ │
│ └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

#### 状态码颜色
| 状态码范围 | 颜色 |
|-----------|------|
| 2xx | `.green` |
| 3xx | `.orange` |
| 4xx | `.red` |
| 5xx | `.purple` |

---

### 4.7 测速页面 (SpeedTestView)

```
┌─────────────────────────────────────────┐
│ ← 网速测试                              │
├─────────────────────────────────────────┤
│                                         │
│           ┌─────────────┐               │
│           │  ○○○○○○○○○  │  ← 进度环     │
│           │             │               │
│           │   125.6     │               │
│           │   Mbps      │               │
│           │             │               │
│           └─────────────┘               │
│                                         │
│   ↓ 下载          ↑ 上传                │
│   125.6 Mbps      45.2 Mbps             │
│   15.7 MB/s       5.6 MB/s              │
│                                         │
│   ⏱ 延迟          〰 抖动               │
│   27.5 ms         3.2 ms                │
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │ ⚠️ 预估流量消耗            [4G]    │ │  ← 仅移动网络显示
│ │                                     │ │
│ │   ↓下载    │   ↑上传    │   总计    │ │
│ │  ~125 MB   │   ~25 MB   │  ~150 MB  │ │
│ │                                     │ │
│ │ 实际流量取决于网速，速度越快消耗越多  │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │         [开始测速]                  │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │ 📶 网速等级          [WiFi百兆宽带] │ │  ← 测速完成后显示
│ │                                     │ │
│ │ 📊 实际流量消耗            ~150 MB  │ │  ← 仅移动网络显示
│ └─────────────────────────────────────┘ │
│                                         │
│ 应用延迟测试                             │
│ ┌─────────────────────────────────────┐ │
│ │ 腾讯系                    ● 极佳    │ │
│ │ ┌─────────────┬─────────────┐      │ │
│ │ │ 腾讯新闻 25ms│ 微信    28ms│      │ │
│ │ │ 王者荣耀 35ms│ 腾讯云  22ms│      │ │
│ │ └─────────────┴─────────────┘      │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 使用 Cloudflare 测速服务器               │
└─────────────────────────────────────────┘
```

#### 样式规范

**速度仪表盘 (SpeedGaugeView)**:
- **圆形进度环**: 200pt 直径，20pt 线宽
- **背景环**: 灰色 0.2 透明度
- **进度环**: 渐变色（根据阶段变化）
  - 延迟阶段: 橙色 → 黄色
  - 下载阶段: 蓝色 → 青色
  - 上传阶段: 绿色 → 薄荷色
- **中心数字**: `.system(size: 48, weight: .bold, design: .rounded)`
- **速度单位**: `Mbps` + `MB/s` 双单位显示

**预估流量卡片 (DataUsageEstimateView)**:
- **显示条件**: 移动网络 + 未开始测速
- **背景**: `Color.orange.opacity(0.08)`
- **边框**: `Color.orange.opacity(0.3)`, 1pt
- **圆角**: 12pt
- **标题图标**: `exclamationmark.triangle.fill` (橙色)
- **网络类型标签**: 橙色背景胶囊
- **流量显示**: 3 列等宽（下载/上传/总计）
- **说明文字**: `.caption2`, `.secondary`

**网速等级卡片 (SpeedTestResultView)**:
- **显示条件**: 测速完成后
- **背景**: 等级颜色 0.1 透明度
- **边框**: 等级颜色 0.3 透明度, 1pt
- **圆角**: 12pt
- **内边距**: 水平 12pt, 垂直 10pt
- **等级标签**: 胶囊形，等级颜色背景，白色文字
- **实际流量**: 仅移动网络显示，单行布局

**网速等级配色**:

| 等级 | 图标 | 颜色 | 中文名称 |
|------|------|------|----------|
| 慢速 | `tortoise.fill` | `.red` | 网络较慢 |
| 4G普通 | `antenna.radiowaves.left.and.right` | `.orange` | 4G普通网速 |
| 4G良好 | `antenna.radiowaves.left.and.right` | `.yellow` | 4G良好网速 |
| 5G | `antenna.radiowaves.left.and.right.circle.fill` | `.green` | 5G网速 |
| WiFi百兆 | `wifi` | `.blue` | WiFi百兆宽带 |
| WiFi 500M | `wifi` | `.cyan` | WiFi 500M宽带 |
| WiFi千兆 | `wifi.circle.fill` | `.purple` | WiFi千兆宽带 |
| 极速 | `bolt.horizontal.circle.fill` | `.pink` | 极速网络 |

**流量提醒弹窗**:
- **触发条件**: 移动网络下点击开始测速
- **标题**: "流量提醒"
- **内容**: 提示正在使用移动数据 + 预估流量
- **按钮**: "取消" (cancel role) + "继续测试"

**应用延迟卡片**:
- **布局**: 两列 `LazyVGrid`
- **分类标题**: `.headline`
- **整体质量指示**: 圆点 + 文字（极佳/良好/一般/较差）
- **单个应用**: 图标 + 名称 + 延迟值
- **刷新按钮**: 仅第一分类显示

---

### 4.8 设备信息页面 (DeviceInfoView)

```
┌─────────────────────────────────────────┐
│ ← 本机信息                              │
├─────────────────────────────────────────┤
│ 公网 IP                                  │
│ ┌─────────────────────────────────────┐ │
│ │ IP: 1.2.3.4                    [📋]│ │
│ │ 归属地: 广东 深圳                    │ │
│ │ 运营商: 中国电信                     │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 设备信息                                 │
│ ┌─────────────────────────────────────┐ │
│ │ 设备名称: iPhone 15 Pro             │ │
│ │ 系统版本: iOS 17.0                  │ │
│ │ 设备型号: iPhone16,1                │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 网络状态                                 │
│ ┌─────────────────────────────────────┐ │
│ │ 网络类型: WiFi                      │ │
│ │ WiFi名称: MyNetwork                 │ │
│ │ 本地IP: 192.168.1.100               │ │
│ └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

---

### 4.9 一键诊断页面 (QuickDiagnosisView)

```
┌─────────────────────────────────────────┐
│ ← 一键诊断                              │
├─────────────────────────────────────────┤
│                                         │
│ 请输入诊断码                             │
│ ┌─────────────────────────────────────┐ │
│ │ [_] [_] [_] [_] [_] [_]            │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │         [开始诊断]                  │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 诊断进度                                 │
│ ┌─────────────────────────────────────┐ │
│ │ ✓ Ping www.qq.com                   │ │
│ │ ● TCP 443 www.qq.com                │ │
│ │ ○ DNS www.baidu.com                 │ │
│ │ ○ Traceroute www.google.com         │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 诊断结果                                 │
│ ┌─────────────────────────────────────┐ │
│ │ 总任务: 10                          │ │
│ │ 成功: 8  失败: 2                    │ │
│ │                                     │ │
│ │ [上报结果]                          │ │
│ └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

#### 样式规范

**渐变色定义**:
```swift
static let gradientBlue = Color(red: 0.2, green: 0.4, blue: 0.9)
static let gradientPurple = Color(red: 0.6, green: 0.3, blue: 0.9)
```

**诊断码输入**:
- 6 位数字输入框
- 每位独立显示
- 自动跳转下一位
- 字体: `.title`, `.monospaced`

**任务状态图标**:
- ✓ 完成: 绿色勾选
- ● 进行中: 蓝色圆点 + 旋转动画
- ○ 等待中: 灰色空心圆
- ✗ 失败: 红色叉号

---

## 五、Tab 2 - 云探测 (CloudProbeView)

### 5.1 页面结构

```
┌─────────────────────────────────────────┐
│ 云探测                                   │
├─────────────────────────────────────────┤
│ 探测类型                                 │
│ [Ping] [DNS] [TCP] [UDP]                │
│                                         │
│ 目标地址                                 │
│ ┌─────────────────────────────────────┐ │
│ │ www.qq.com                          │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 端口 (TCP/UDP 时显示)                    │
│ ┌─────────────────────────────────────┐ │
│ │ 443                                 │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 记录类型 (DNS 时显示)                    │
│ [A] [AAAA] [CNAME] [MX] [TXT]          │
│                                         │
│ 筛选条件                                 │
│ ┌─────────────────────────────────────┐ │
│ │ 国家: [全部] [中国] [美国] ...      │ │
│ │ 运营商: [全部] [电信] [移动] ...    │ │
│ │ AS号: [全部] [AS4134] ...           │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │         [开始探测]                  │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 探测结果 (12 条记录)              [清空] │
│ ┌─────────────────────────────────────┐ │
│ │ 源: 广东 电信                       │ │
│ │ 目的: www.qq.com                    │ │
│ │ 平均: 25ms  最小: 20ms  丢包: 0%    │ │
│ └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

### 5.2 样式规范

**探测类型选择器**:
- 布局: `Picker` + `segmented` 样式
- 选项: Ping, DNS, TCP, UDP

**筛选条件**:
- 使用 `DisclosureGroup` 折叠
- 多选 Picker

**结果卡片**:
- 背景: `Color(.systemBackground)`
- 圆角: 12pt
- 左侧状态条: 4pt 宽, 渐变色
- 成功: 绿色
- 失败: 红色
- 部分成功: 橙色

---

## 六、Tab 3 - IP查询 (IPQueryView)

### 6.1 页面结构

```
┌─────────────────────────────────────────┐
│                                         │
├─────────────────────────────────────────┤
│ IP地址                                   │
│ ┌─────────────────────────────────────┐ │
│ │ 🌐 请输入IP地址         [⏱] [X]    │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 历史记录 (展开时显示)                    │
│ ┌─────────────────────────────────────┐ │
│ │ ⏱ 1.2.3.4                      [X] │ │
│ │ ⏱ 5.6.7.8                      [X] │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │         [🔍 查询]                   │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 查询结果                                 │
│ ┌─────────────────────────────────────┐ │
│ │ IP              1.2.3.4            │ │
│ ├─────────────────────────────────────┤ │
│ │ 国家            中国                │ │
│ ├─────────────────────────────────────┤ │
│ │ 省份            广东                │ │
│ ├─────────────────────────────────────┤ │
│ │ 城市            深圳                │ │
│ ├─────────────────────────────────────┤ │
│ │ 运营商          电信                │ │
│ ├─────────────────────────────────────┤ │
│ │ 完整归属地      中国 广东 深圳 电信  │ │
│ └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

### 6.2 样式规范

#### 输入框区域
- **背景**: `Color(.systemBackground)`
- **圆角**: 8pt
- **边框**: 未输入时 `systemGray4` 0.5pt，输入时 `blue` 1.5pt
- **内边距**: 14pt
- **图标**: `globe`，有输入时蓝色，无输入时灰色

#### 历史记录
- **最大记录数**: 10 条
- **存储**: `UserDefaults` (key: `IPQueryHistory`)
- **自动去重**: 新查询自动移到最前
- **删除**: 支持单条删除

#### 查询按钮
- **背景**: 有输入时 `.blue`，无输入时 `systemGray4`
- **前景色**: `.white`
- **字体**: `.semibold`
- **圆角**: 10pt
- **内边距**: 14pt (垂直)
- **宽度**: 全宽 (`maxWidth: .infinity`)

#### 结果卡片
- **布局**: 列表式，每行一个字段
- **背景**: `Color(.systemBackground)`
- **圆角**: 8pt
- **分隔线**: `Divider`，左侧 16pt 缩进
- **行内边距**: 水平 16pt，垂直 14pt
- **长按菜单**: 支持复制当前值

#### 错误提示
- **图标**: `exclamationmark.triangle.fill` (橙色)
- **文字颜色**: `.secondary`

---

## 七、Tab 4 - 数据 (ChinaMapView)

### 7.1 数据类型颜色定义

| 数据类型 | 颜色 |
|----------|------|
| 丢包 | `.orange` |
| 延时 | `.purple` |
| 不可达率 | `.red` |

### 7.2 页面结构

```
┌─────────────────────────────────────────┐
│ 告警地图                         [刷新] │
├─────────────────────────────────────────┤
│ ┌─────────────────────────────────────┐ │
│ │                                     │ │
│ │         [中国地图 WebView]          │ │
│ │         (ECharts 渲染)              │ │
│ │         - 飞线动画                  │ │
│ │         - 涟漪效果                  │ │
│ │                                     │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ ● 严重(L1)  ● 中等(L2)  ● 轻微(L3)      │
│                                         │
│ 🔔 全部告警                        [15] │
│ 筛选: 广东                         [X]  │
│ ─────────────────────────────────────── │
│ ┌─────────────────────────────────────┐ │
│ │ │ 杭州 → 3个地区 · 电信        [L1]│ │
│ │ │ 🕐 21:48 · 延迟                   │ │
│ │ ├───────────────────────────────────│ │
│ │ │ 杭州到广东等地区延迟异常告警...   │ │ ← 展开详情
│ └─────────────────────────────────────┘ │
│ ┌─────────────────────────────────────┐ │
│ │ │ 成都 → 5个地区 · 移动        [L2]│ │
│ │ │ 🕐 昨天 20:15 · 丢包              │ │
│ └─────────────────────────────────────┘ │
│ ┌─────────────────────────────────────┐ │
│ │ │ 北京 → 2个地区 · 联通        [L3]│ │
│ │ │ 🕐 12-24 18:30 · 延迟             │ │
│ └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

### 7.3 样式规范

#### 导航栏
- **标题**: "告警地图"
- **标题样式**: `.inline`
- **右侧按钮**: 刷新按钮 `arrow.clockwise`
  - 加载中显示 `ProgressView`
  - 刷新成功显示 Toast 提示

#### 地图区域
- **高度**: 屏幕高度 * 0.4
- **背景**: 渐变色 `LinearGradient`
  - 起始色: `Color(.systemBackground)`
  - 结束色: `Color.blue.opacity(0.03)`
- **边框**: 蓝色渐变描边, 1.5pt
  - 起始色: `Color.blue.opacity(0.4)`
  - 结束色: `Color.blue.opacity(0.15)`
- **圆角**: 16pt
- **阴影**: `shadow(color: .blue.opacity(0.1), radius: 10, x: 0, y: 4)`
- **内边距**: 水平 12pt，顶部 8pt

#### 加载状态
- **Loading**: `ProgressView` + "加载中..." 文字
- **错误状态**: 
  - 图标: `exclamationmark.triangle.fill` (红色, `.largeTitle`)
  - 标题: "加载失败" (`.headline`)
  - 错误信息: `.caption`, `.secondary`
  - 重试按钮: 蓝色背景，白色文字

#### 图例
- **布局**: 水平排列 `HStack`
- **间距**: 16pt
- **图例项**: 圆点 (8pt) + 文字
- **颜色**:
  | 级别 | 颜色 | 文字 |
  |------|------|------|
  | L1 严重 | `.red` | "严重(L1)" |
  | L2 中等 | `.yellow` | "中等(L2)" |
  | L3 轻微 | `Color(red: 1.0, green: 0.6, blue: 0.6)` | "轻微(L3)" |

#### 告警列表标题栏
- **图标**: `bell.badge.fill` (橙色, `.subheadline`)
- **标题**: "全部告警" (`.subheadline`, `.semibold`)
- **计数标签**: 
  - 背景: 蓝色胶囊 `Capsule`
  - 文字: 白色, `.caption`, `.bold`
  - 内边距: 水平 8pt，垂直 3pt
- **清除筛选按钮**: `xmark.circle.fill` (`.secondary.opacity(0.6)`)

#### 筛选标签
- **显示条件**: 选中省份时显示
- **文字**: "筛选: {省份名}" (`.caption`, `.blue`)
- **对齐**: 左对齐

#### 告警行样式
- **左侧状态条**:
  - 宽度: 4pt
  - 高度: 50pt
  - 圆角: 2pt
  - 颜色: 渐变色（根据告警级别）
- **内容区域**:
  - **第一行**: 源城市 → 目标数量 · 运营商
    - 源城市: `.subheadline`, `.medium`
    - 箭头: `arrow.right` (10pt, `.secondary`)
    - 目标数量: ".subheadline`, `.secondary`
    - 运营商: `.caption`, `.blue`
  - **第二行**: 时间 · 数据类型 · 恢复状态
    - 时钟图标: `clock` (10pt, `.secondary`)
    - 时间: `.caption`, `.secondary`
    - 数据类型: `.caption`, 灰色背景标签
    - 已恢复: `.caption2`, 绿色背景标签
- **右侧**:
  - **级别标签**: 
    - 文字: "L1"/"L2"/"L3" (`.caption`, `.semibold`)
    - 背景: 胶囊形，对应颜色 0.12 透明度
    - 文字颜色: 对应告警颜色
  - **展开箭头**: `chevron.down` (`.caption2`, `.secondary`)
    - 展开时旋转 180°

#### 展开详情
- **动画**: `.spring(response: 0.35, dampingFraction: 0.8)`
- **分隔线**: 左侧缩进 14pt
- **详情文字**: `.caption`, `.secondary`
- **内边距**: 左 14pt，右 8pt，底 8pt

#### 空状态
- **图标**: `checkmark.shield.fill` (`.title2`, `.green.opacity(0.6)`)
- **文字**: "暂无告警数据" (`.subheadline`, `.secondary`)
- **垂直内边距**: 40pt

#### Toast 提示
- **位置**: 顶部居中
- **样式**: 
  - 图标: `checkmark.circle.fill` (绿色)
  - 文字: "刷新成功" (`.subheadline`)
  - 背景: `.ultraThinMaterial`
  - 圆角: 20pt
  - 阴影: `.black.opacity(0.1)`, radius 5, y 2
- **动画**: `.move(edge: .top).combined(with: .opacity)`
- **显示时长**: 1.5 秒

### 7.4 告警时间显示规则

| 时间 | 显示格式 | 示例 |
|------|----------|------|
| 今天 | HH:mm | 21:48 |
| 昨天 | 昨天 HH:mm | 昨天 20:15 |
| 更早 | MM-dd HH:mm | 12-24 18:30 |

### 7.5 交互说明

1. **地图点击**: 点击省份筛选该省份相关告警
2. **清除筛选**: 点击 X 按钮清除省份筛选
3. **告警展开**: 点击告警行展开/收起详情
4. **刷新数据**: 点击刷新按钮重新加载数据
5. **页面进入**: 自动加载最近 24 小时未恢复告警

---

## 八、Tab 5 - 我的 (ProfileView)

### 8.1 页面结构

```
┌─────────────────────────────────────────┐
│ 我的                                     │
├─────────────────────────────────────────┤
│ ┌─────────────────────────────────────┐ │
│ │ 👤 点击登录                         │ │
│ │    登录后可使用云探测功能            │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 功能                                     │
│ ┌─────────────────────────────────────┐ │
│ │ 📋 任务历史                      >  │ │
│ ├─────────────────────────────────────┤ │
│ │ ❓ 帮助中心                      >  │ │
│ ├─────────────────────────────────────┤ │
│ │ 💬 意见反馈                      >  │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 设置                                     │
│ ┌─────────────────────────────────────┐ │
│ │ ⚙️ 设置                          >  │ │
│ ├─────────────────────────────────────┤ │
│ │ ℹ️ 关于                          >  │ │
│ └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

### 8.2 登录后状态

```
┌─────────────────────────────────────────┐
│ ┌─────────────────────────────────────┐ │
│ │ 👤 用户名                           │ │
│ │    游客账号                         │ │
│ │                            [退出]   │ │
│ └─────────────────────────────────────┘ │
```

### 8.3 样式规范

**用户卡片**:
- 背景: `Color(.systemBackground)`
- 圆角: 16pt
- 内边距: 16pt
- 头像: 50pt 圆形, 蓝色渐变背景

**功能列表**:
- 列表样式: `.insetGrouped`
- 图标: SF Symbols
- 箭头: `chevron.right`

---

## 九、登录页面 (LoginView)

### 9.1 页面结构

```
┌─────────────────────────────────────────┐
│ [取消]        登录                       │
├─────────────────────────────────────────┤
│                                         │
│           [App Logo]                    │
│        iTango 网络探测                   │
│        全球网络探测平台                   │
│                                         │
│ [手机号登录] [账号登录] [游客登录]        │
│                                         │
│ 用户类型                                 │
│ [外部用户] [内部用户]                    │
│                                         │
│ 手机号                                   │
│ ┌─────────────────────────────────────┐ │
│ │ 请输入手机号                        │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 验证码                                   │
│ ┌─────────────────────────────────────┐ │
│ │ 请输入验证码           [获取验证码] │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │              [登录]                 │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ ☑ 我已阅读并同意                        │
│ 《用户服务协议》《隐私政策摘要》          │
│ 《隐私政策完整版》《第三方SDK目录》       │
└─────────────────────────────────────────┘
```

### 9.2 样式规范

**Logo**:
- 游客模式: 80pt, 圆角 18pt
- 其他模式: 50pt, 圆角 12pt

**登录方式选择器**:
- 布局: 水平等分
- 选中: 蓝色背景, 白色文字
- 未选中: 灰色背景 0.15 透明度

**输入框**:
- 背景: `Color.gray.opacity(0.1)`
- 圆角: 10pt
- 内边距: 16pt

**验证码按钮**:
- 宽度: 90pt
- 可用: 蓝色背景
- 不可用: 灰色背景 0.3 透明度

**登录按钮**:
- 可用: 蓝色背景
- 不可用: 灰色背景
- 圆角: 12pt
- 内边距: 16pt (垂直)

**协议链接**:
- 颜色: `.blue`
- 字体: `.caption`

---

## 十、设置页面 (SettingsView)

### 10.1 页面结构

```
┌─────────────────────────────────────────┐
│ ← 设置                                   │
├─────────────────────────────────────────┤
│ 显示设置                                 │
│ ┌─────────────────────────────────────┐ │
│ │ 每行工具数    [2] [3] [4]           │ │
│ ├─────────────────────────────────────┤ │
│ │ 首页样式      [现代] [经典]         │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 语言设置                                 │
│ ┌─────────────────────────────────────┐ │
│ │ 中文                            ✓   │ │
│ ├─────────────────────────────────────┤ │
│ │ English                             │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 隐私与协议                               │
│ ┌─────────────────────────────────────┐ │
│ │ 用户服务协议                     >  │ │
│ │ 隐私政策摘要                     >  │ │
│ │ 隐私政策完整版                   >  │ │
│ │ 已收集个人信息清单               >  │ │
│ │ 第三方SDK目录                    >  │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 账号管理 (登录后显示)                    │
│ ┌─────────────────────────────────────┐ │
│ │ 注销账号                            │ │
│ │ 退出登录                            │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 关于                                     │
│ ┌─────────────────────────────────────┐ │
│ │ 版本              1.0.0             │ │
│ │ Build             1                 │ │
│ └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

---

## 十一、任务历史页面 (TaskHistoryView)

### 11.1 页面结构

```
┌─────────────────────────────────────────┐
│ [?] 任务历史              [上传] [清空] │
├─────────────────────────────────────────┤
│ [全部] [Ping] [Trace] [DNS] [TCP] ...   │
├─────────────────────────────────────────┤
│ 今天                                     │
│ ┌─────────────────────────────────────┐ │
│ │ ● Ping [成功]                       │ │
│ │   www.qq.com                        │ │
│ │   平均延迟: 25.3ms             14:30│ │
│ ├─────────────────────────────────────┤ │
│ │ ● DNS [成功]                        │ │
│ │   www.baidu.com                     │ │
│ │   解析成功: 2条记录            14:25│ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 昨天                                     │
│ ┌─────────────────────────────────────┐ │
│ │ ● TCP [失败]                        │ │
│ │   www.google.com:443                │ │
│ │   连接超时                     20:15│ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 历史记录保留 14 天                       │
└─────────────────────────────────────────┘
```

### 11.2 样式规范

**筛选栏**:
- 布局: `ScrollView(.horizontal)`
- 按钮样式: 胶囊形 (`FilterChip`)
- 选中: 蓝色背景, 白色文字
- 未选中: `systemGray5` 背景

**记录行**:
- 左侧图标: 44pt 圆形, 状态色 0.15 透明度背景
- 状态标签: 胶囊形, 小字体
- 时间: 右对齐, `.caption2`

**状态颜色**:
- 成功: `.green`
- 失败: `.red`
- 部分成功: `.orange`

**滑动操作**:
- 右滑: 上传 (蓝色), 删除 (红色)

---

## 十二、关于页面 (AboutView)

```
┌─────────────────────────────────────────┐
│ ← 关于                                   │
├─────────────────────────────────────────┤
│                                         │
│           [App Icon]                    │
│            iTango                       │
│        版本 1.0.0 (1)                   │
│                                         │
│ 版本信息                                 │
│ ┌─────────────────────────────────────┐ │
│ │ 当前版本              1.0.0         │ │
│ │ Build 号              1             │ │
│ │ 检查更新                         >  │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 开发信息                                 │
│ ┌─────────────────────────────────────┐ │
│ │ 开发者              iTango Team     │ │
│ │ 版权              © 2025 ZJC        │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 相关链接                                 │
│ ┌─────────────────────────────────────┐ │
│ │ 🌐 官方网站                      ↗  │ │
│ └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

---

## 十三、抓包页面 (PacketCaptureView)

### 13.1 页面结构

```
┌─────────────────────────────────────────┐
│ ← 网络抓包       [证书] [过滤] [导出] [清]│
├─────────────────────────────────────────┤
│ ┌─────────────────────────────────────┐ │
│ │ ● 抓包状态: 已连接                  │ │
│ │                                     │ │
│ │ ┌─────────────────────────────────┐ │ │
│ │ │         [停止抓包]              │ │ │
│ │ └─────────────────────────────────┘ │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ ┌───────┬───────┬───────┬───────┐      │
│ │数据包 │总流量 │ 上行  │ 下行  │      │
│ │  125  │ 2.5MB │ 500KB │ 2.0MB │      │
│ └───────┴───────┴───────┴───────┘      │
│                                         │
│ 🔍 搜索 IP、URL 或关键词                │
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │ ↑ [HTTPS] api.example.com      200 │ │
│ │   14:30:25 • 1.2KB                  │ │
│ ├─────────────────────────────────────┤ │
│ │ ↓ [TCP] 192.168.1.1:443            │ │
│ │   14:30:24 • 256B                   │ │
│ └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

### 13.2 样式规范

**VPN 状态颜色**:
- 已连接: `.green`
- 连接中/断开中: `.orange`
- 未连接: `.gray`

**协议标签颜色**:
| 协议 | 颜色 |
|------|------|
| TCP | `.orange` |
| UDP | `.green` |
| ICMP | `.purple` |
| HTTP | `.blue` |
| HTTPS | `.cyan` |
| DNS | `.indigo` |

**状态码颜色**:
| 范围 | 颜色 |
|------|------|
| 2xx | `.green` |
| 3xx | `.orange` |
| 4xx | `.red` |
| 5xx | `.purple` |

---

## 十四、通用 UI 组件

### 14.1 Toast 提示

```swift
// 上传成功/失败 Toast
HStack(spacing: 8) {
    Image(systemName: isSuccess ? "checkmark.circle.fill" : "xmark.circle.fill")
        .foregroundColor(isSuccess ? .green : .red)
    Text(message)
        .font(.subheadline)
        .foregroundColor(.white)
}
.padding(.horizontal, 16)
.padding(.vertical, 10)
.background(Color.black.opacity(0.8))
.cornerRadius(20)
```

### 14.2 复制提示 (CopyToastView)

用于显示复制成功的提示，在多个页面中使用（如 IP 查询、设备信息等）。

```swift
struct CopyToastView: View {
    let message: String
    
    var body: some View {
        HStack(spacing: 8) {
            Image(systemName: "doc.on.doc.fill")
                .foregroundColor(.white)
            Text(message)
                .font(.subheadline)
                .foregroundColor(.white)
        }
        .padding(.horizontal, 16)
        .padding(.vertical, 10)
        .background(Color.black.opacity(0.8))
        .cornerRadius(20)
    }
}
```

**使用场景**:
- IP 查询结果复制
- 设备信息复制
- 测试结果复制

### 14.3 加载指示器

```swift
VStack(spacing: 12) {
    ProgressView()
        .scaleEffect(1.2)
    Text("加载中...")
        .font(.caption)
        .foregroundColor(.secondary)
}
```

### 14.4 空状态视图

```swift
VStack(spacing: 16) {
    Image(systemName: "clock.arrow.circlepath")
        .font(.system(size: 60))
        .foregroundColor(.secondary.opacity(0.5))
    
    Text("暂无数据")
        .font(.headline)
        .foregroundColor(.secondary)
}
```

---

## 十五、颜色规范

### 15.1 主题色

| 用途 | 颜色 |
|------|------|
| 主色调 | `.blue` |
| 成功 | `.green` |
| 警告 | `.orange` |
| 错误 | `.red` |
| 次要文字 | `.secondary` |

### 15.2 背景色

| 用途 | 颜色 |
|------|------|
| 页面背景 | `Color(.systemGroupedBackground)` |
| 卡片背景 | `Color(.systemBackground)` |
| 输入框背景 | `Color(.systemGray6)` |
| 按钮禁用背景 | `Color.gray.opacity(0.3)` |

---

## 十六、字体规范

| 用途 | 字体 |
|------|------|
| 大标题 | `.largeTitle` |
| 标题 | `.title`, `.title2`, `.title3` |
| 正文标题 | `.headline` |
| 正文 | `.body` |
| 副标题 | `.subheadline` |
| 说明文字 | `.caption`, `.caption2` |
| 等宽字体 | `.system(design: .monospaced)` |

---

## 十七、间距规范

| 用途 | 间距 |
|------|------|
| 页面边距 | 16pt |
| 卡片内边距 | 12-16pt |
| 元素间距 | 8-12pt |
| 紧凑间距 | 4pt |

---

## 十八、圆角规范

| 组件 | 圆角 |
|------|------|
| 大卡片 | 16pt |
| 普通卡片 | 12pt |
| 按钮 | 10-12pt |
| 输入框 | 10pt |
| 小标签 | 4-6pt |
| 胶囊形 | `Capsule()` |

---

## 十九、页面跳转关系

```
ContentView (TabView)
├── Tab 1: HomeView (本地测)
│   ├── → QuickDiagnosisView (一键诊断)
│   ├── → DeviceInfoView (本机信息)
│   ├── → SpeedTestView (测速)
│   ├── → PingView (Ping)
│   ├── → TraceView (路由追踪)
│   ├── → TCPView (TCP)
│   ├── → UDPView (UDP)
│   ├── → DNSView (DNS)
│   ├── → HTTPGetView (HTTP)
│   ├── → PacketCaptureView (抓包)
│   └── → SettingsView (设置)
│       └── → LegalDocumentView (协议文档)
│
├── Tab 2: CloudProbeView (云探测)
│
├── Tab 3: IPQueryView (IP查询)
│
├── Tab 4: ChinaMapView (数据/告警地图)
│
└── Tab 5: ProfileView (我的)
    ├── → LoginView (登录) [Sheet]
    │   └── → AgreementView (协议详情) [Sheet]
    ├── → TaskHistoryView (任务历史)
    │   └── → TaskHistoryDetailView (历史详情)
    ├── → SettingsView (设置)
    └── → AboutView (关于)
```

---

## 二十、动画效果

### 20.1 页面转场
- 使用 `NavigationStack` 默认推入动画
- Sheet 使用系统默认上滑动画

### 20.2 状态变化
- 按钮状态: `.easeInOut(duration: 0.2)`
- 列表刷新: `withAnimation`
- Toast 显示: `.move(edge: .top).combined(with: .opacity)`

### 20.3 加载动画
- `ProgressView()` 系统默认旋转
- 自定义脉冲动画: `rippleEffect`

---

## 二十一、深色模式支持

应用完全支持深色模式，通过 `@Environment(\.colorScheme)` 检测当前模式并动态调整样式。

### 21.1 检测方式

```swift
@Environment(\.colorScheme) private var colorScheme

// 使用示例
let isDark = colorScheme == .dark
```

### 21.2 系统语义颜色

| 用途 | 颜色 | 浅色模式 | 深色模式 |
|------|------|----------|----------|
| 页面背景 | `Color(.systemGroupedBackground)` | 浅灰 | 纯黑 |
| 卡片背景 | `Color(.systemBackground)` | 白色 | 深灰 |
| 次级背景 | `Color(.secondarySystemBackground)` | 浅灰 | 深灰 |
| 主要文字 | `Color.primary` | 黑色 | 白色 |
| 次要文字 | `Color.secondary` | 灰色 | 浅灰 |
| 输入框背景 | `Color(.systemGray6)` | 浅灰 | 深灰 |

### 21.3 条件样式适配

**Logo 切换**:
```swift
Image(colorScheme == .dark ? "itango_night_logo" : "itango_logo")
```

**卡片背景**:
```swift
// 深色模式使用 secondarySystemBackground，浅色使用 systemBackground
colorScheme == .dark ? Color(.secondarySystemBackground) : Color(.systemBackground)
```

**透明度调整**:
```swift
// 深色模式下图标背景透明度更高
color.opacity(colorScheme == .dark ? 0.25 : 0.15)

// 深色模式下阴影更明显
shadow(color: .black.opacity(colorScheme == .dark ? 0.3 : 0.05), ...)
```

**边框显示**:
```swift
// 深色模式添加微弱白色边框增强层次感
.stroke(colorScheme == .dark ? Color.white.opacity(0.1) : Color.clear, lineWidth: 1)
```

### 21.4 WebView 深色模式

地图 WebView 通过 JavaScript 函数同步深色模式状态：

**Swift 调用**:
```swift
let script = "if(typeof updateDarkMode === 'function') updateDarkMode(\(colorScheme == .dark));"
webView.evaluateJavaScript(script, completionHandler: nil)
```

**JavaScript 实现**:
```javascript
var isDarkMode = false;

function updateDarkMode(dark) {
    isDarkMode = dark;
    // 重新渲染图表
    if (myChart) {
        myChart.setOption(getOption());
    }
}

// 根据模式调整样式
backgroundColor: isDarkMode ? 'rgba(30, 40, 60, 0.9)' : 'rgba(255, 255, 255, 0.9)',
borderColor: isDarkMode ? 'rgba(100, 180, 255, 0.3)' : '#ccc',
color: isDarkMode ? '#fff' : '#333'
```

### 21.5 地图星空背景

深色模式下，地图页面显示星空背景效果，增强视觉沉浸感。

**实现方式**:
```swift
// 仅在深色模式下显示星空背景
if colorScheme == .dark {
    StarryBackgroundView()
}
```

**StarryBackgroundView 实现**:
```swift
struct StarryBackgroundView: View {
    // 使用静态数据，避免重复生成
    private static let starData: [(xRatio: CGFloat, yRatio: CGFloat, size: CGFloat, opacity: Double)] = {
        var result: [(CGFloat, CGFloat, CGFloat, Double)] = []
        // 使用固定种子生成，确保每次结果一致
        srand48(42)
        for _ in 0..<80 {
            result.append((
                CGFloat(drand48()),  // x 位置比例
                CGFloat(drand48()),  // y 位置比例
                CGFloat(drand48() * 1.5 + 1),  // 大小 1~2.5pt
                drand48() * 0.6 + 0.4  // 透明度 0.4~1.0
            ))
        }
        return result
    }()
    
    var body: some View {
        ZStack {
            // 深色渐变背景
            LinearGradient(
                colors: [
                    Color(red: 0.02, green: 0.05, blue: 0.12),
                    Color(red: 0.05, green: 0.08, blue: 0.18),
                    Color(red: 0.03, green: 0.06, blue: 0.14)
                ],
                startPoint: .topLeading,
                endPoint: .bottomTrailing
            )
            
            // 使用 Canvas 绘制静态星星，性能更好且位置稳定
            Canvas { context, size in
                for star in Self.starData {
                    let rect = CGRect(
                        x: star.xRatio * size.width - star.size / 2,
                        y: star.yRatio * size.height - star.size / 2,
                        width: star.size,
                        height: star.size
                    )
                    context.opacity = star.opacity
                    context.fill(Circle().path(in: rect), with: .color(.white))
                }
            }
        }
    }
}
```

**设计要点**:
| 特性 | 说明 |
|------|------|
| 星星数量 | 80 颗 |
| 位置生成 | 固定种子 (42)，确保每次位置一致 |
| 大小范围 | 1 ~ 2.5pt |
| 透明度范围 | 0.4 ~ 1.0 |
| 渲染方式 | Canvas 高性能绘制 |
| 背景色 | 深蓝渐变 (近乎黑色) |

### 21.6 深色模式适配清单

| 组件 | 适配项 |
|------|--------|
| 首页工具卡片 | 背景色、透明度、边框 |
| 一键诊断卡片 | Logo 图片切换 |
| 地图页面 | 星空背景、WebView 样式 |
| 地图 WebView | 背景、边框、文字颜色 |
| 告警列表 | 渐变色、阴影 |
| 所有卡片 | 使用系统语义颜色 |

